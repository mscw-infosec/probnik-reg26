# Шарашара

## Информация

Гермиона, уже потеряв счет всяким интересным книгам и конспектам всех предметов подряд,
еще раньше своих однокурсников столкнулась с несовершенством бумаги как носителя сотен
рукописных листов информации. Впрочем, это у нее еще личной стопки документов нет,
да и у читателя такое наверняка еще впереди.

Будучи из магловской семьи, на каникулах она решила попросить сисадмина с маминой работы
наклепать свое онлайн-хранилище файлов, вместо того, чтобы поднять существующую. Гермиона-то, конечно,
только прикидывается не умеющей программировать – она же ходила на пары по ассемблеру! А потому и
сразу заподозрила, что с такой шары не то что конспекты да книжки, а вся жизнь может утечь.

И вам предстоит убедиться в том самим – найти, что же скрывает тот сервак, помимо пяти документов.

## Решение

Поначалу нам доступно только API управления файлами: перечислением и чтением. Интерфейс не дает перечислять файлы выше текущей директории, однако, проэксплуатировав стандартную LFI, добиваемся этого: `/listdir?dir=../`. Там можем найти исходники таска, nginx.conf и флаг. Аналогичной LFI их скачиваем `/download?path=../flag.txt`.

В nginx.conf есть интересный хост `server_name level2.local;`. Пока что все выглядит, как будто именно этот конфиг nginx развернут в контейнере. Как это проверить? Попробовать постучаться на указанный домен. Но такого нет на внешнем DNS! Есть два выхода – прокидывать при каждом запросе заголовок `Host: level2.local` или поменять `/etc/hosts`, добавив туда запись на IP-адрес сервера с тасками.

Итак, мы сходили на сервис с определнным заголовком Host. На нем нужно провернуть PPC по решению математических примеров. Поначалу это упражнение на перекладывание ответов сервера и питоновский eval. С определенного примера появляется операция `^` (но это не XOR, а возведение в степень), еще чуть позже появятся дроби в виде `\frac{}{}`.
