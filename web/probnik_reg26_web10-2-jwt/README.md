# Восточный шпионаж

## Информация

А вот и суббота!

На парах по защите от темных искусств свежевербованный преподаватель начал пояснять,
кому можно секретные заклинания и прочую силушку нечис... магию тайную показывать,
а кому (ну то есть маглам) не очень.

Кто ж его знает, зачем тот же препод начал им рассказывать про JWT, небось и поможет это найти смысл в
Турнире трёх волшебников, захватить мир и наконец купить квартиру в центре ~~Москвы~~ Хогсмида,
но больно хорошо Чжоу Чанг усвоила всю секретность тех самых строчек на `eyJhb`. Уже желая узнать все
тайны мальчика с молнией посередине лба, наверстала она ему декодер их, родимых.

Гарри наш тоже был не палочкой деланный, и на правах очень внимательного слушателя и отличника по зельеварению
раскрыл план когтевранки. Чего только не придумают шестнадцатилетние чародеи, чтобы повеселиться над шпионами –
например, Гарри, прочитав вашу пояснительную записку, придумал обратиться к Вам, как к опытному специалисту в кибербезопасности.

## Решение

В таске два флага.

Сначала надо наPPCшить пин-код от админки (быки и коровы). За это дают легкий флаг.

Как делать PPC: в запросах можно юзать одинаковые цифры, поэтому можно сделать 10 запросов вида `111111`,
чтобы узнать, сколько раз встречается каждая цифра, потом с какой-нибудь неиспользуемой цифрой (пусть 6) делать
запросы вида `166666`, `616666` и тд так мы сможем узнать, на каких позициях единичка. В сто запросов точно уложиться можно.

Можно еще меньше думать и выбирать случайное число, которое подходит под такие критерии. Написанный одним промптом в гптшку алгос справился за 10 попыток.

В админке реализован поиск по alg в jwt body (как мы видим из сорцов). Оптимально использовать либо слепую SQL-инъекцию с бинпоиском (но это ~400 запросов), либо UNION-based: `' UNION SELECT jwt FROM tokens; -- `. После этого надругательства над базой данных можно пойти раздекодить JWT этим же сервисом, ибо автор таска заботится о людях.
