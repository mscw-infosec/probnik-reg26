# Печати

Один могущественный волшебник решил запечатать свои тайны, зашифровав их и спрятав в далёкой-далёкой пещере на самом краю суши. Мы нашли пещеру и запечатанный секрет, но печать слишком сильна - мы не можем сорвать её просто так. Помогите нам найти ключ, с помощью которого волшебник запечатал свои тайны. Мы знаем, что при наложении печати использовался AES-256-CBC.

- Рекомендуемые утилиты: OpenSSL.
- Цель работы: дешифрование флага.
- Итог работы: получение доступа к флагу.
- Критерий оценки: предоставление правильного флага.

## Решение

Нас просят найти ключ - попробуем сделать это перебором. Для этого попробуем перебрать по одному из самых известных словарей паролей - `rockyou.txt`. В Kali Linux он сжат и находится по адресу `/usr/share/wordlists/rockyou.txt.gz`.

Напишем небольшой скрипт, который будет перебирать пароли из `rockyou.txt`, а в случае если в получившимся тексте найдётся фраза `vsosh{` - выводить флаг и останавливать перебор.

```sh
#!/bin/bash

FILE="flag.txt.enc"
WORDLIST="/home/justmarfix/Downloads/rockyou.txt"

while read -r pass; do
    echo "[*] Trying: $pass"
    if openssl enc -d -aes-256-cbc \
        -in "$FILE" \
        -pass pass:"$pass" \
        -out decrypted.txt 2>/dev/null; then

        if grep -q "vsosh{" decrypted.txt; then
            echo "[+] PASSWORD FOUND: $pass"
            cat decrypted.txt
            exit 0
        fi
    fi
done < "$WORDLIST"
```
