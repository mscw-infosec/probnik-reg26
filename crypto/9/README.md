# 9 Crypto - XORwarts

## Описание

В архивах Отдела Тайн Министерства Магии обнаружено зашифрованное сообщение.
Известно, что оно зашифровано простым XOR-ключом, но сам ключ утерян в архивах.

Восстановите ключ XOR и расшифруйте сообщение, чтобы раскрыть тайну, спрятанную невыразимцами.

- Рекомендуемые утилиты: Python.
- Цель работы: анализ представленного криптографического алгоритма.
- Итог работы: получение доступа к флагу.
- Критерий оценки: предоставление правильного флага.

## Решение

Из описания мы знаем, что сообщение зашифровано с помощью операции XOR с неизвестным ключом.

Ключ генерируется так:
1.  Берутся первые два символа флага: `'v'` и `'s'`.
2.  Для каждого из них вычисляется MD5-хэш, который представляет собой 16-байтное значение.
3.  Каждое 16-байтовое значение преобразуется в большое целое число.
4.  Финальный ключ получается путем XOR между этими двумя числами.


Имея ключ, мы можем расшифровать сообщение.

1.  Каждое число из списка cipher ксорим с нашим XOR_KEY.
2.  В результате получаем ASCII-код каждого символа исходного сообщения.
3.  ASCII-символы собиарем в одну строку.

Получается base64 строка. И последний шаг - декодировать её.


## Solver

```python
import base64
import hashlib

cipher = [209943576549313400704819639269693894010, 209943576549313400704819639269693894000, 209943576549313400704819639269693893968, 209943576549313400704819639269693893992, 209943576549313400704819639269693894013, 209943576549313400704819639269693893932, 209943576549313400704819639269693894006, 209943576549313400704819639269693893929, 209943576549313400704819639269693894013, 209943576549313400704819639269693893988, 209943576549313400704819639269693893976, 209943576549313400704819639269693893994, 209943576549313400704819639269693894013, 209943576549313400704819639269693893977, 209943576549313400704819639269693893993, 209943576549313400704819639269693893988, 209943576549313400704819639269693893958, 209943576549313400704819639269693893932, 209943576549313400704819639269693893968, 209943576549313400704819639269693893991, 209943576549313400704819639269693894011, 209943576549313400704819639269693893958, 209943576549313400704819639269693893980, 209943576549313400704819639269693893934, 209943576549313400704819639269693893971, 209943576549313400704819639269693893976, 209943576549313400704819639269693893927, 209943576549313400704819639269693893999, 209943576549313400704819639269693894010, 209943576549313400704819639269693893958, 209943576549313400704819639269693893968, 209943576549313400704819639269693893934, 209943576549313400704819639269693893958, 209943576549313400704819639269693893932, 209943576549313400704819639269693893956, 209943576549313400704819639269693893992, 209943576549313400704819639269693894013, 209943576549313400704819639269693894002, 209943576549313400704819639269693893927, 209943576549313400704819639269693894003, 209943576549313400704819639269693894010, 209943576549313400704819639269693893961, 209943576549313400704819639269693893931, 209943576549313400704819639269693893927]

XOR_KEY_1 = int.from_bytes(hashlib.md5('v'.encode()).digest(), 'big')
XOR_KEY_2 = int.from_bytes(hashlib.md5('s'.encode()).digest(), 'big')
XOR_KEY = XOR_KEY_1 ^ XOR_KEY_2

flag = ""
for c in cipher:
    decrypted_block = c ^ XOR_KEY
    flag += chr(decrypted_block)

print(flag)


print(base64.b64decode(flag).decode())
```
